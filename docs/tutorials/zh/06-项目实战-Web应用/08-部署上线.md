# æ¨¡å— 8: éƒ¨ç½²ä¸Šçº¿

> å°†åº”ç”¨éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ

## å­¦ä¹ ç›®æ ‡

- å‡†å¤‡ç”Ÿäº§ç¯å¢ƒæ„å»º
- é…ç½®ç¯å¢ƒå˜é‡
- éƒ¨ç½²åˆ°äº‘å¹³å°
- è®¾ç½®åŸŸåå’Œ HTTPS
- ç›‘æ§å’Œç»´æŠ¤

## 1. ç”Ÿäº§ç¯å¢ƒå‡†å¤‡

### ç¯å¢ƒé…ç½®

**.env.production**:
```
NODE_ENV=production
PORT=3000
DB_PATH=/var/data/tasks.db
JWT_SECRET=your-secure-production-secret
CLIENT_URL=https://yourdomain.com
```

### package.json è„šæœ¬

```json
{
  "scripts": {
    "start": "NODE_ENV=production node server/index.js",
    "dev": "nodemon server/index.js",
    "build": "npm install --production",
    "test": "jest"
  }
}
```

## 2. éƒ¨ç½²åˆ° Heroku

### æ­¥éª¤ 1: å®‰è£… Heroku CLI

```bash
# macOS
brew install heroku/brew/heroku

# Windows
# ä¸‹è½½å¹¶å®‰è£… Heroku CLI
```

### æ­¥éª¤ 2: åˆ›å»ºåº”ç”¨

```bash
# ç™»å½• Heroku
heroku login

# åˆ›å»ºåº”ç”¨
heroku create your-app-name

# è®¾ç½®ç¯å¢ƒå˜é‡
heroku config:set JWT_SECRET=your-secret
heroku config:set NODE_ENV=production
```

### æ­¥éª¤ 3: éƒ¨ç½²

```bash
# æ¨é€åˆ° Heroku
git push heroku main

# æŸ¥çœ‹æ—¥å¿—
heroku logs --tail

# æ‰“å¼€åº”ç”¨
heroku open
```

## 3. éƒ¨ç½²åˆ° Vercel

### vercel.json

```json
{
  "version": 2,
  "builds": [
    {
      "src": "server/index.js",
      "use": "@vercel/node"
    }
  ],
  "routes": [
    {
      "src": "/api/(.*)",
      "dest": "server/index.js"
    },
    {
      "src": "/(.*)",
      "dest": "/client/$1"
    }
  ]
}
```

### éƒ¨ç½²å‘½ä»¤

```bash
# å®‰è£… Vercel CLI
npm i -g vercel

# ç™»å½•
vercel login

# éƒ¨ç½²
vercel

# éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ
vercel --prod
```

## 4. éƒ¨ç½²åˆ°è‡ªå·±çš„æœåŠ¡å™¨

### ä½¿ç”¨ PM2

```bash
# å®‰è£… PM2
npm install -g pm2

# å¯åŠ¨åº”ç”¨
pm2 start server/index.js --name "todo-app"

# æŸ¥çœ‹çŠ¶æ€
pm2 status

# æŸ¥çœ‹æ—¥å¿—
pm2 logs

# é‡å¯
pm2 restart todo-app

# å¼€æœºè‡ªå¯åŠ¨
pm2 startup
pm2 save
```

### Nginx é…ç½®

```nginx
server {
    listen 80;
    server_name yourdomain.com;

    location / {
        proxy_pass http://localhost:3000;
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection 'upgrade';
        proxy_set_header Host $host;
        proxy_cache_bypass $http_upgrade;
    }
}
```

## 5. HTTPS é…ç½®

### ä½¿ç”¨ Let's Encrypt

```bash
# å®‰è£… Certbot
sudo apt-get install certbot python3-certbot-nginx

# è·å–è¯ä¹¦
sudo certbot --nginx -d yourdomain.com

# è‡ªåŠ¨ç»­æœŸ
sudo certbot renew --dry-run
```

## 6. æ€§èƒ½ä¼˜åŒ–

### Gzip å‹ç¼©

```javascript
const compression = require('compression');
app.use(compression());
```

### é™æ€èµ„æºç¼“å­˜

```javascript
app.use(express.static('client', {
    maxAge: '1d',
    etag: true
}));
```

## 7. ç›‘æ§å’Œæ—¥å¿—

### ä½¿ç”¨ Winston

```javascript
const winston = require('winston');

const logger = winston.createLogger({
    level: 'info',
    format: winston.format.json(),
    transports: [
        new winston.transports.File({ filename: 'error.log', level: 'error' }),
        new winston.transports.File({ filename: 'combined.log' })
    ]
});

if (process.env.NODE_ENV !== 'production') {
    logger.add(new winston.transports.Console({
        format: winston.format.simple()
    }));
}
```

## 8. æ•°æ®åº“å¤‡ä»½

```bash
# å¤‡ä»½è„šæœ¬
#!/bin/bash
DATE=$(date +%Y%m%d_%H%M%S)
sqlite3 /var/data/tasks.db ".backup /backups/tasks_$DATE.db"

# ä¿ç•™æœ€è¿‘7å¤©çš„å¤‡ä»½
find /backups -name "tasks_*.db" -mtime +7 -delete

# æ·»åŠ åˆ° crontab
# æ¯å¤©å‡Œæ™¨2ç‚¹å¤‡ä»½
0 2 * * * /path/to/backup.sh
```

## å…³é”®è¦ç‚¹

1. **ç¯å¢ƒé…ç½®** - æ­£ç¡®è®¾ç½®ç”Ÿäº§ç¯å¢ƒå˜é‡
2. **éƒ¨ç½²é€‰é¡¹** - é€‰æ‹©é€‚åˆçš„æ‰˜ç®¡å¹³å°
3. **HTTPS** - å¯ç”¨å®‰å…¨è¿æ¥
4. **ç›‘æ§** - å®æ—¶ç›‘æ§åº”ç”¨çŠ¶æ€
5. **å¤‡ä»½** - å®šæœŸå¤‡ä»½æ•°æ®åº“

## é¡¹ç›®å®Œæˆæ£€æŸ¥æ¸…å•

```
âœ… æ‰€æœ‰åŠŸèƒ½æ­£å¸¸å·¥ä½œ
âœ… é€šè¿‡æ‰€æœ‰æµ‹è¯•
âœ… ä»£ç å·²å®¡æŸ¥å’Œä¼˜åŒ–
âœ… æ–‡æ¡£å·²å®Œæˆ
âœ… ç¯å¢ƒå˜é‡å·²é…ç½®
âœ… HTTPS å·²å¯ç”¨
âœ… ç›‘æ§å·²è®¾ç½®
âœ… å¤‡ä»½ç­–ç•¥å·²å®æ–½
âœ… æ€§èƒ½ä¼˜åŒ–å·²å®Œæˆ
âœ… å®‰å…¨æ£€æŸ¥å·²é€šè¿‡
```

## æ­å–œ!

ä½ å·²ç»å®Œæˆäº†å®Œæ•´çš„ Web åº”ç”¨å¼€å‘æµç¨‹,ä»è§„åˆ’åˆ°éƒ¨ç½²ã€‚è¿™ä¸ªé¡¹ç›®å±•ç¤ºäº†:

- å‰ç«¯å¼€å‘æŠ€èƒ½
- åç«¯ API è®¾è®¡
- æ•°æ®åº“é›†æˆ
- ç”¨æˆ·è®¤è¯
- éƒ¨ç½²å’Œè¿ç»´

ç»§ç»­å­¦ä¹ æ›´å¤šé«˜çº§ä¸»é¢˜!

---

ğŸ“š **è¿”å›**: [ç¬¬å…­è¯¾æ¦‚è¿°](./index.md)
